"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){return e instanceof RegExp?e.source:null==e?".*":e}var d=function(){function e(t,n){r(this,e),this.routes=t||{},this.context=n||this,this.notFound=null,this.navigate=this.navigate.bind(this)}return o(e,[{key:"start",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.addEventListener("hashchange",this.navigate),e&&this.navigate()}},{key:"stop",value:function(){window.removeEventListener("hashchange",this.navigate)}},{key:"navigate",value:function(){var e=this.constructor.normalize(window.location.hash);for(var t in this.routes){var n=e.match(new RegExp("^".concat(t,"$")));if(n)return this.routes[t].apply(this.context,n)}if("function"==typeof this.notFound)return this.notFound.call(this.context,e)}}],[{key:"normalize",value:function(e){return e.replace(/^#|\/*$/g,"")}}]),e}(),m="#fff",b={debug:!1,defaultDataYear:"2022",dataUrls:{yearList:"data/years.json",yearsBase:"data/years",artistsByGenres:"data/artists-by-genres.json"},links:{lastfm:{url:"https://www.last.fm/user/markhovskiy/",text:"markhovskiy"},github:{url:"https://github.com/music-stats/timeline/",text:"music-stats/timeline"},twitter:{url:"https://twitter.com/oleksmarkh/",text:"@oleksmarkh"}},timeline:{zoomDeltaFactor:.01,minTimeRange:864e5,plot:{padding:12,backgroundColor:"#283038"},point:{size:3,maxMargin:1,selectedColor:m,colorValueFactors:{other:{saturation:.5,lightness:.6},genre:{saturation:1.1,lightness:1},artistLabel:{saturation:1.4,lightness:1.6},artist:{saturation:1.4,lightness:1.8}}},labels:{areaPadding:4,margin:1,highlightedHeight:16,highlightedColor:m},timeAxis:{width:2,tickLabelCount:40,timeFullColor:"#484848",timeRangeColor:"#686868"},legend:{height:150},unknownGenreColorRange:["#525252","#bdbdbd"]},genreGroups:{Classical:{colorRange:["#bdbdbd","#f0f0f0"],genres:["Classical","Tango"]},"Electronic, Pop":{colorRange:["#cc4c02","#fec44f"],genres:["Ambient","Darkwave","Dream Pop","Electronic","Indie Pop","Industrial","Pop","Singer-songwriter","Trip Hop"]},Jazzy:{colorRange:["#fec44f","#fff7bc"],genres:["Blues","Funk","Hip-hop","Jazz","Low Rock","Reggae","Rock And Roll","Rockabilly","Soul"]},Folk:{colorRange:["#238b45","#a1d99b"],genres:["Acoustic","Bluegrass","Dark Country","Dark Folk","Folk Metal","Folk Rock","Folk","Freak Folk","Ukrainian Retro"]},Rock:{colorRange:["#2171b5","#9ecae1"],genres:["Alternative Rock","Classic Rock","Gothic Rock","Indie Rock","Industrial Rock","Instrumental Virtuoso","Pop Rock","Post-rock","Progressive Rock","Stoner Rock"]},Metal:{colorRange:["#88419d","#9ebcda"],genres:["Black Metal","Death Metal","Deathcore","Doom Metal","Gothic Metal","Groove Metal","Heavy Metal","Industrial Metal","Melodic Black Metal","Melodic Death Metal","Metalcore","Nu Metal","Post-black","Power Metal","Progressive Death Metal","Progressive Metal","Sludge Metal","Symphonic Metal","Thrash Metal"]},Punk:{colorRange:["#ce1256","#c994c7"],genres:["Grunge","Hardcore","Post-hardcore","Post-punk","Proto-punk","Punk Rock","Screamo","Ska Punk","Ska"]}}};function p(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function v(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function y(){}var w="\\s*([+-]?\\d+)\\s*",k="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",x="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",M=/^#([0-9a-f]{3,8})$/,L=new RegExp("^rgb\\(".concat(w,",").concat(w,",").concat(w,"\\)$")),C=new RegExp("^rgb\\(".concat(x,",").concat(x,",").concat(x,"\\)$")),S=new RegExp("^rgba\\(".concat(w,",").concat(w,",").concat(w,",").concat(k,"\\)$")),E=new RegExp("^rgba\\(".concat(x,",").concat(x,",").concat(x,",").concat(k,"\\)$")),T=new RegExp("^hsl\\(".concat(k,",").concat(x,",").concat(x,"\\)$")),D=new RegExp("^hsla\\(".concat(k,",").concat(x,",").concat(x,",").concat(k,"\\)$")),P={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function A(){return this.rgb().formatHex()}function N(){return this.rgb().formatRgb()}function R(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=M.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?U(t):3===n?new j(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?H(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?H(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=L.exec(e))?new j(t[1],t[2],t[3],1):(t=C.exec(e))?new j(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=S.exec(e))?H(t[1],t[2],t[3],t[4]):(t=E.exec(e))?H(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=T.exec(e))?G(t[1],t[2]/100,t[3]/100,1):(t=D.exec(e))?G(t[1],t[2]/100,t[3]/100,t[4]):P.hasOwnProperty(e)?U(P[e]):"transparent"===e?new j(NaN,NaN,NaN,0):null}function U(e){return new j(e>>16&255,e>>8&255,255&e,1)}function H(e,t,n,r){return r<=0&&(e=t=n=NaN),new j(e,t,n,r)}function F(e){return e instanceof y||(e=R(e)),e?new j((e=e.rgb()).r,e.g,e.b,e.opacity):new j}function j(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function I(){return"#".concat(Y(this.r)).concat(Y(this.g)).concat(Y(this.b))}function O(){var e=_(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(z(this.r),", ").concat(z(this.g),", ").concat(z(this.b)).concat(1===e?")":", ".concat(e,")"))}function _(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function z(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Y(e){return((e=z(e))<16?"0":"")+e.toString(16)}function G(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new q(e,t,n,r)}function B(e){if(e instanceof q)return new q(e.h,e.s,e.l,e.opacity);if(e instanceof y||(e=R(e)),!e)return new q;if(e instanceof q)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,l=o-i,s=(o+i)/2;return l?(a=t===o?(n-r)/l+6*(n<r):n===o?(r-t)/l+2:(t-n)/l+4,l/=s<.5?o+i:2-o-i,a*=60):l=s>0&&s<1?0:a,new q(a,l,s,e.opacity)}function V(e,t,n,r){return 1===arguments.length?B(e):new q(e,t,n,null==r?1:r)}function q(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function W(e){return(e=(e||0)%360)<0?e+360:e}function $(e){return Math.max(0,Math.min(1,e||0))}function X(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Z(e,n){var r=b.genreGroups,i={},o={},a=function(e){r[e].genres.forEach((function(t){return i[t]=e}))};for(var l in r)a(l);var s=function(e){n[e].forEach((function(t){return o[t]=e}))};for(var u in n)s(u);return e.map((function(e){var n=o[e.artist.name],r=i[n];return t(t({},e),n&&{artist:t(t({},e.artist),{},{genreGroup:r,genre:n})})}))}function J(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function K(e){var t=e,n=e;function r(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;n(e[o],t)<0?r=o+1:i=o}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return J(e(t),n)}}(e)),{left:r,center:function(e,n,i,o){null==i&&(i=0),null==o&&(o=e.length);var a=r(e,n,i,o-1);return a>i&&t(e[a-1],n)>-t(e[a],n)?a-1:a},right:function(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;n(e[o],t)>0?i=o:r=o+1}return r}}}p(y,R,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:A,formatHex:A,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return B(this).formatHsl()},formatRgb:N,toString:N}),p(j,(function(e,t,n,r){return 1===arguments.length?F(e):new j(e,t,n,null==r?1:r)}),v(y,{brighter:function(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new j(z(this.r),z(this.g),z(this.b),_(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:I,formatHex:I,formatHex8:function(){return"#".concat(Y(this.r)).concat(Y(this.g)).concat(Y(this.b)).concat(Y(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:O,toString:O})),p(q,V,v(y,{brighter:function(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new q(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new q(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new j(X(e>=240?e-240:e+120,i,r),X(e,i,r),X(e<120?e+240:e-120,i,r),this.opacity)},clamp:function(){return new q(W(this.h),$(this.s),$(this.l),_(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=_(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(W(this.h),", ").concat(100*$(this.s),"%, ").concat(100*$(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));var Q=K(J).right;K((function(e){return null===e?NaN:+e})).center;var ee=Q,te=Math.sqrt(50),ne=Math.sqrt(10),re=Math.sqrt(2);function ie(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=te?10:o>=ne?5:o>=re?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=te?10:o>=ne?5:o>=re?2:1)}function oe(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=te?i*=10:o>=ne?i*=5:o>=re&&(i*=2),t<e?-i:i}function ae(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function le(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}function se(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ue(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ce(){}var he=1/.7,fe="\\s*([+-]?\\d+)\\s*",ge="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",de="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",me=/^#([0-9a-f]{3,8})$/,be=new RegExp("^rgb\\("+[fe,fe,fe]+"\\)$"),pe=new RegExp("^rgb\\("+[de,de,de]+"\\)$"),ve=new RegExp("^rgba\\("+[fe,fe,fe,ge]+"\\)$"),ye=new RegExp("^rgba\\("+[de,de,de,ge]+"\\)$"),we=new RegExp("^hsl\\("+[ge,de,de]+"\\)$"),ke=new RegExp("^hsla\\("+[ge,de,de,ge]+"\\)$"),xe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Me(){return this.rgb().formatHex()}function Le(){return this.rgb().formatRgb()}function Ce(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=me.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Se(t):3===n?new Pe(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Ee(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Ee(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=be.exec(e))?new Pe(t[1],t[2],t[3],1):(t=pe.exec(e))?new Pe(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ve.exec(e))?Ee(t[1],t[2],t[3],t[4]):(t=ye.exec(e))?Ee(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=we.exec(e))?Ue(t[1],t[2]/100,t[3]/100,1):(t=ke.exec(e))?Ue(t[1],t[2]/100,t[3]/100,t[4]):xe.hasOwnProperty(e)?Se(xe[e]):"transparent"===e?new Pe(NaN,NaN,NaN,0):null}function Se(e){return new Pe(e>>16&255,e>>8&255,255&e,1)}function Ee(e,t,n,r){return r<=0&&(e=t=n=NaN),new Pe(e,t,n,r)}function Te(e){return e instanceof ce||(e=Ce(e)),e?new Pe((e=e.rgb()).r,e.g,e.b,e.opacity):new Pe}function De(e,t,n,r){return 1===arguments.length?Te(e):new Pe(e,t,n,null==r?1:r)}function Pe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Ae(){return"#"+Re(this.r)+Re(this.g)+Re(this.b)}function Ne(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Re(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Ue(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Fe(e,t,n,r)}function He(e){if(e instanceof Fe)return new Fe(e.h,e.s,e.l,e.opacity);if(e instanceof ce||(e=Ce(e)),!e)return new Fe;if(e instanceof Fe)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,l=o-i,s=(o+i)/2;return l?(a=t===o?(n-r)/l+6*(n<r):n===o?(r-t)/l+2:(t-n)/l+4,l/=s<.5?o+i:2-o-i,a*=60):l=s>0&&s<1?0:a,new Fe(a,l,s,e.opacity)}function Fe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function je(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}se(ce,Ce,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Me,formatHex:Me,formatHsl:function(){return He(this).formatHsl()},formatRgb:Le,toString:Le}),se(Pe,De,ue(ce,{brighter:function(e){return e=null==e?he:Math.pow(he,e),new Pe(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Pe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ae,formatHex:Ae,formatRgb:Ne,toString:Ne})),se(Fe,(function(e,t,n,r){return 1===arguments.length?He(e):new Fe(e,t,n,null==r?1:r)}),ue(ce,{brighter:function(e){return e=null==e?he:Math.pow(he,e),new Fe(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Fe(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Pe(je(e>=240?e-240:e+120,i,r),je(e,i,r),je(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var Ie=function(e){return function(){return e}};function Oe(e){return 1==(e=+e)?_e:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Ie(isNaN(t)?n:t)}}function _e(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Ie(isNaN(e)?t:e)}var ze=function e(t){var n=Oe(t);function r(e,t){var r=n((e=De(e)).r,(t=De(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=_e(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function Ye(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function Ge(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Ze(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function Be(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ve(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function qe(e,t){var r,i={},o={};for(r in null!==e&&"object"===n(e)||(e={}),null!==t&&"object"===n(t)||(t={}),t)r in e?i[r]=Ze(e[r],t[r]):o[r]=t[r];return function(e){for(r in i)o[r]=i[r](e);return o}}var We=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$e=new RegExp(We.source,"g");function Xe(e,t){var n,r,i,o=We.lastIndex=$e.lastIndex=0,a=-1,l=[],s=[];for(e+="",t+="";(n=We.exec(e))&&(r=$e.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),l[a]?l[a]+=i:l[++a]=i),(n=n[0])===(r=r[0])?l[a]?l[a]+=r:l[++a]=r:(l[++a]=null,s.push({i:a,x:Ve(n,r)})),o=$e.lastIndex;return o<t.length&&(i=t.slice(o),l[a]?l[a]+=i:l[++a]=i),l.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)l[(n=s[r]).i]=n.x(e);return l.join("")})}function Ze(e,t){var r,i,o=n(t);return null==t||"boolean"===o?Ie(t):("number"===o?Ve:"string"===o?(r=Ce(t))?(t=r,ze):Xe:t instanceof Ce?ze:t instanceof Date?Be:(i=t,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(t)?Ge:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?qe:Ve:Ye))(e,t)}function Je(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Ke(e){return+e}var Qe=[0,1];function et(e){return e}function tt(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function nt(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=tt(i,r),o=n(a,o)):(r=tt(r,i),o=n(o,a)),function(e){return o(r(e))}}function rt(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=tt(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=ee(e,t,1,r)-1;return o[n](i[n](t))}}function it(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ot(){var e,t,n,r,i,o,a=Qe,l=Qe,s=Ze,u=et;function c(){var e=Math.min(a.length,l.length);return u!==et&&(u=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(a[0],a[e-1])),r=e>2?rt:nt,i=o=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(a.map(e),l,s)))(e(u(t)))}return h.invert=function(n){return u(t((o||(o=r(l,a.map(e),Ve)))(n)))},h.domain=function(e){return arguments.length?(a=Array.from(e,Ke),c()):a.slice()},h.range=function(e){return arguments.length?(l=Array.from(e),c()):l.slice()},h.rangeRound=function(e){return l=Array.from(e),s=Je,c()},h.clamp=function(e){return arguments.length?(u=!!e||et,c()):u!==et},h.interpolate=function(e){return arguments.length?(s=e,c()):s},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,c()}}function at(){return ot()(et,et)}function lt(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function st(e){return(e=lt(Math.abs(e)))?e[1]:NaN}var ut,ct=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ht(e){if(!(t=ct.exec(e)))throw new Error("invalid format: "+e);var t;return new ft({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function ft(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function gt(e,t){var n=lt(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}ht.prototype=ft.prototype,ft.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var dt={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return gt(100*e,t)},r:gt,s:function(e,t){var n=lt(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(ut=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+lt(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function mt(e){return e}var bt,pt,vt,yt=Array.prototype.map,wt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function kt(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?mt:(t=yt.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,l=t[0],s=0;i>0&&l>0&&(s+l+1>r&&(l=Math.max(1,r-s)),o.push(e.substring(i-=l,i+l)),!((s+=l+1)>r));)l=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",l=void 0===e.numerals?mt:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(yt.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"−":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=ht(e)).fill,n=e.align,h=e.sign,f=e.symbol,g=e.zero,d=e.width,m=e.comma,b=e.precision,p=e.trim,v=e.type;"n"===v?(m=!0,v="g"):dt[v]||(void 0===b&&(b=12),p=!0,v="g"),(g||"0"===t&&"="===n)&&(g=!0,t="0",n="=");var y="$"===f?i:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===f?o:/[%p]/.test(v)?s:"",k=dt[v],x=/[defgprs%]/.test(v);function M(e){var i,o,s,f=y,M=w;if("c"===v)M=k(e)+M,e="";else{var L=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:k(Math.abs(e),b),p&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),L&&0==+e&&"+"!==h&&(L=!1),f=(L?"("===h?h:u:"-"===h||"("===h?"":h)+f,M=("s"===v?wt[8+ut/3]:"")+M+(L&&"("===h?")":""),x)for(i=-1,o=e.length;++i<o;)if(48>(s=e.charCodeAt(i))||s>57){M=(46===s?a+e.slice(i+1):e.slice(i))+M,e=e.slice(0,i);break}}m&&!g&&(e=r(e,1/0));var C=f.length+e.length+M.length,S=C<d?new Array(d-C+1).join(t):"";switch(m&&g&&(e=r(S+e,S.length?d-M.length:1/0),S=""),n){case"<":e=f+e+M+S;break;case"=":e=f+S+e+M;break;case"^":e=S.slice(0,C=S.length>>1)+f+e+M+S.slice(C);break;default:e=S+f+e+M}return l(e)}return b=void 0===b?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),M.toString=function(){return e+""},M}return{format:h,formatPrefix:function(e,t){var n=h(((e=ht(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(st(t)/3))),i=Math.pow(10,-r),o=wt[8+r/3];return function(e){return n(i*e)+o}}}}function xt(e,t,n,r){var i,o=oe(e,t,n);switch((r=ht(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(st(t)/3)))-st(Math.abs(e)))}(o,a))||(r.precision=i),vt(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,st(t)-st(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-st(Math.abs(e)))}(o))||(r.precision=i-2*("%"===r.type))}return pt(r)}function Mt(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var r,i,o,a,l=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(a=ie(e,t,n))||!isFinite(a))return[];if(a>0){var s=Math.round(e/a),u=Math.round(t/a);for(s*a<e&&++s,u*a>t&&--u,o=new Array(i=u-s+1);++l<i;)o[l]=(s+l)*a}else{a=-a;var c=Math.round(e*a),h=Math.round(t*a);for(c/a<e&&++c,h/a>t&&--h,o=new Array(i=h-c+1);++l<i;)o[l]=(c+l)/a}return r&&o.reverse(),o}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return xt(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,o=t(),a=0,l=o.length-1,s=o[a],u=o[l],c=10;for(u<s&&(i=s,s=u,u=i,i=a,a=l,l=i);c-- >0;){if((i=ie(s,u,n))===r)return o[a]=s,o[l]=u,t(o);if(i>0)s=Math.floor(s/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;s=Math.ceil(s*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function Lt(){var e=at();return e.copy=function(){return it(e,Lt())},ae.apply(e,arguments),Mt(e)}bt=kt({thousands:",",grouping:[3],currency:["$",""]}),pt=bt.format,vt=bt.formatPrefix;var Ct=new Date,St=new Date;function Et(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,l=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return l;do{l.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return l},i.filter=function(n){return Et((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(i.count=function(t,r){return Ct.setTime(+t),St.setTime(+r),e(Ct),e(St),Math.floor(n(Ct,St))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var Tt=Et((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));Tt.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Et((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):Tt:null};var Dt=Tt;Tt.range;var Pt=Et((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+1e3*t)}),(function(e,t){return(t-e)/1e3}),(function(e){return e.getUTCSeconds()})),At=Pt;Pt.range;var Nt=Et((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())}),(function(e,t){e.setTime(+e+6e4*t)}),(function(e,t){return(t-e)/6e4}),(function(e){return e.getMinutes()})),Rt=Nt;Nt.range;var Ut=Et((function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-6e4*e.getMinutes())}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getHours()})),Ht=Ut;Ut.range;var Ft=Et((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5}),(function(e){return e.getDate()-1})),jt=Ft;function It(e){return Et((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5}))}Ft.range;var Ot=It(0),_t=It(1),zt=It(2),Yt=It(3),Gt=It(4),Bt=It(5),Vt=It(6);Ot.range,_t.range,zt.range,Yt.range,Gt.range,Bt.range,Vt.range;var qt=Et((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),Wt=qt;qt.range;var $t=Et((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));$t.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Et((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var Xt=$t;$t.range;var Zt=Et((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+6e4*t)}),(function(e,t){return(t-e)/6e4}),(function(e){return e.getUTCMinutes()})),Jt=Zt;Zt.range;var Kt=Et((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+36e5*t)}),(function(e,t){return(t-e)/36e5}),(function(e){return e.getUTCHours()})),Qt=Kt;Kt.range;var en=Et((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/864e5}),(function(e){return e.getUTCDate()-1})),tn=en;function nn(e){return Et((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/6048e5}))}en.range;var rn=nn(0),on=nn(1),an=nn(2),ln=nn(3),sn=nn(4),un=nn(5),cn=nn(6);rn.range,on.range,an.range,ln.range,sn.range,un.range,cn.range;var hn=Et((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),fn=hn;hn.range;var gn=Et((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));gn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Et((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var dn=gn;function mn(e,t,n,r,i,o){var a=[[At,1,1e3],[At,5,5e3],[At,15,15e3],[At,30,3e4],[o,1,6e4],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[t,1,2592e6],[t,3,7776e6],[e,1,31536e6]];function l(t,n,r){var i=Math.abs(n-t)/r,o=K((function(e){return u(e,3)[2]})).right(a,i);if(o===a.length)return e.every(oe(t/31536e6,n/31536e6,r));if(0===o)return Dt.every(Math.max(oe(t,n,r),1));var l=u(a[i/a[o-1][2]<a[o][2]/i?o-1:o],2),s=l[0],c=l[1];return s.every(c)}return[function(e,t,n){var r=t<e;if(r){var i=[t,e];e=i[0],t=i[1]}var o=n&&"function"==typeof n.range?n:l(e,t,n),a=o?o.range(e,+t+1):[];return r?a.reverse():a},l]}gn.range;var bn=u(mn(dn,fn,rn,tn,Qt,Jt),2);bn[0],bn[1];var pn=u(mn(Xt,Wt,Ot,jt,Ht,Rt),2),vn=pn[0],yn=pn[1];function wn(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function kn(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xn(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var Mn,Ln,Cn={"-":"",_:" ",0:"0"},Sn=/^\s*\d+/,En=/^%/,Tn=/[\\^$*+?|[\]().{}]/g;function Dn(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Pn(e){return e.replace(Tn,"\\$&")}function An(e){return new RegExp("^(?:"+e.map(Pn).join("|")+")","i")}function Nn(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function Rn(e,t,n){var r=Sn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Un(e,t,n){var r=Sn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Hn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Fn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function jn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function In(e,t,n){var r=Sn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function On(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function _n(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function zn(e,t,n){var r=Sn.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Yn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Gn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Bn(e,t,n){var r=Sn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Vn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function qn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Wn(e,t,n){var r=Sn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function $n(e,t,n){var r=Sn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Xn(e,t,n){var r=Sn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Zn(e,t,n){var r=En.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Jn(e,t,n){var r=Sn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Kn(e,t,n){var r=Sn.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Qn(e,t){return Dn(e.getDate(),t,2)}function er(e,t){return Dn(e.getHours(),t,2)}function tr(e,t){return Dn(e.getHours()%12||12,t,2)}function nr(e,t){return Dn(1+jt.count(Xt(e),e),t,3)}function rr(e,t){return Dn(e.getMilliseconds(),t,3)}function ir(e,t){return rr(e,t)+"000"}function or(e,t){return Dn(e.getMonth()+1,t,2)}function ar(e,t){return Dn(e.getMinutes(),t,2)}function lr(e,t){return Dn(e.getSeconds(),t,2)}function sr(e){var t=e.getDay();return 0===t?7:t}function ur(e,t){return Dn(Ot.count(Xt(e)-1,e),t,2)}function cr(e){var t=e.getDay();return t>=4||0===t?Gt(e):Gt.ceil(e)}function hr(e,t){return e=cr(e),Dn(Gt.count(Xt(e),e)+(4===Xt(e).getDay()),t,2)}function fr(e){return e.getDay()}function gr(e,t){return Dn(_t.count(Xt(e)-1,e),t,2)}function dr(e,t){return Dn(e.getFullYear()%100,t,2)}function mr(e,t){return Dn((e=cr(e)).getFullYear()%100,t,2)}function br(e,t){return Dn(e.getFullYear()%1e4,t,4)}function pr(e,t){var n=e.getDay();return Dn((e=n>=4||0===n?Gt(e):Gt.ceil(e)).getFullYear()%1e4,t,4)}function vr(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Dn(t/60|0,"0",2)+Dn(t%60,"0",2)}function yr(e,t){return Dn(e.getUTCDate(),t,2)}function wr(e,t){return Dn(e.getUTCHours(),t,2)}function kr(e,t){return Dn(e.getUTCHours()%12||12,t,2)}function xr(e,t){return Dn(1+tn.count(dn(e),e),t,3)}function Mr(e,t){return Dn(e.getUTCMilliseconds(),t,3)}function Lr(e,t){return Mr(e,t)+"000"}function Cr(e,t){return Dn(e.getUTCMonth()+1,t,2)}function Sr(e,t){return Dn(e.getUTCMinutes(),t,2)}function Er(e,t){return Dn(e.getUTCSeconds(),t,2)}function Tr(e){var t=e.getUTCDay();return 0===t?7:t}function Dr(e,t){return Dn(rn.count(dn(e)-1,e),t,2)}function Pr(e){var t=e.getUTCDay();return t>=4||0===t?sn(e):sn.ceil(e)}function Ar(e,t){return e=Pr(e),Dn(sn.count(dn(e),e)+(4===dn(e).getUTCDay()),t,2)}function Nr(e){return e.getUTCDay()}function Rr(e,t){return Dn(on.count(dn(e)-1,e),t,2)}function Ur(e,t){return Dn(e.getUTCFullYear()%100,t,2)}function Hr(e,t){return Dn((e=Pr(e)).getUTCFullYear()%100,t,2)}function Fr(e,t){return Dn(e.getUTCFullYear()%1e4,t,4)}function jr(e,t){var n=e.getUTCDay();return Dn((e=n>=4||0===n?sn(e):sn.ceil(e)).getUTCFullYear()%1e4,t,4)}function Ir(){return"+0000"}function Or(){return"%"}function _r(e){return+e}function zr(e){return Math.floor(+e/1e3)}function Yr(e){return new Date(e)}function Gr(e){return e instanceof Date?+e:+new Date(+e)}function Br(e,t,n,r,i,o,a,l,s,u){var c=at(),h=c.invert,f=c.domain,g=u(".%L"),d=u(":%S"),m=u("%I:%M"),b=u("%I %p"),p=u("%a %d"),v=u("%b %d"),y=u("%B"),w=u("%Y");function k(e){return(s(e)<e?g:l(e)<e?d:a(e)<e?m:o(e)<e?b:r(e)<e?i(e)<e?p:v:n(e)<e?y:w)(e)}return c.invert=function(e){return new Date(h(e))},c.domain=function(e){return arguments.length?f(Array.from(e,Gr)):f().map(Yr)},c.ticks=function(t){var n=f();return e(n[0],n[n.length-1],null==t?10:t)},c.tickFormat=function(e,t){return null==t?k:u(t)},c.nice=function(e){var n=f();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?f(function(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e}(n,e)):c},c.copy=function(){return it(c,Br(e,t,n,r,i,o,a,l,s,u))},c}function Vr(){return ae.apply(Br(vn,yn,Xt,Wt,Ot,jt,Ht,Rt,At,Ln).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function qr(){var e,t,n,r,i,o=0,a=1,l=et,s=!1;function c(t){return null==t||isNaN(t=+t)?i:l(0===n?.5:(t=(r(t)-e)*n,s?Math.max(0,Math.min(1,t)):t))}function h(e){return function(t){var n,r,i;return arguments.length?(r=(n=u(t,2))[0],i=n[1],l=e(r,i),c):[l(0),l(1)]}}return c.domain=function(i){var l;return arguments.length?(l=u(i,2),o=l[0],a=l[1],e=r(o=+o),t=r(a=+a),n=e===t?0:1/(t-e),c):[o,a]},c.clamp=function(e){return arguments.length?(s=!!e,c):s},c.interpolator=function(e){return arguments.length?(l=e,c):l},c.range=h(Ze),c.rangeRound=h(Je),c.unknown=function(e){return arguments.length?(i=e,c):i},function(i){return r=i,e=i(o),t=i(a),n=e===t?0:1/(t-e),c}}function Wr(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function $r(){var e=Mt(qr()(et));return e.copy=function(){return Wr(e,$r())},le.apply(e,arguments)}function Xr(e,n){var r=b.timeline,i=r.point.colorValueFactors,o=r.unknownGenreColorRange,a=b.genreGroups,l=function(e){return $r().domain([1,n]).range(e)},s=l(o),c={};return Object.entries(a).forEach((function(e){var t=u(e,2),n=t[0],r=t[1].colorRange;return c[n]=l(r)})),e.map((function(e){var n=e.artist.genreGroup,r=e.album.playcount,o=(c[n]||s)(r),a=V(o);a.s*=i.other.saturation,a.l*=i.other.lightness;var l=V(o);l.s*=i.genre.saturation,l.l*=i.genre.lightness;var u=V(o);u.s*=i.artist.saturation,u.l*=i.artist.lightness;var h=V(o);return h.s*=i.artistLabel.saturation,h.l*=i.artistLabel.lightness,[a,l,u,h].forEach((function(e){e.s>1&&(e.s=1),e.l>1&&(e.l=1)})),t(t({},e),{},{color:a,highlightedGenreColor:l,highlightedArtistColor:u,artistLabelColor:h})}))}!function(e){Mn=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,l=e.months,s=e.shortMonths,u=An(i),c=Nn(i),h=An(o),f=Nn(o),g=An(a),d=Nn(a),m=An(l),b=Nn(l),p=An(s),v=Nn(s),y={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return l[e.getMonth()]},c:null,d:Qn,e:Qn,f:ir,g:mr,G:pr,H:er,I:tr,j:nr,L:rr,m:or,M:ar,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:_r,s:zr,S:lr,u:sr,U:ur,V:hr,w:fr,W:gr,x:null,X:null,y:dr,Y:br,Z:vr,"%":Or},w={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return l[e.getUTCMonth()]},c:null,d:yr,e:yr,f:Lr,g:Hr,G:jr,H:wr,I:kr,j:xr,L:Mr,m:Cr,M:Sr,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:_r,s:zr,S:Er,u:Tr,U:Dr,V:Ar,w:Nr,W:Rr,x:null,X:null,y:Ur,Y:Fr,Z:Ir,"%":Or},k={a:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return L(e,t,n,r)},d:Gn,e:Gn,f:Xn,g:On,G:In,H:Vn,I:Vn,j:Bn,L:$n,m:Yn,M:qn,p:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:zn,Q:Jn,s:Kn,S:Wn,u:Un,U:Hn,V:Fn,w:Rn,W:jn,x:function(e,t,r){return L(e,n,t,r)},X:function(e,t,n){return L(e,r,t,n)},y:On,Y:In,Z:_n,"%":Zn};function x(e,t){return function(n){var r,i,o,a=[],l=-1,s=0,u=e.length;for(n instanceof Date||(n=new Date(+n));++l<u;)37===e.charCodeAt(l)&&(a.push(e.slice(s,l)),null!=(i=Cn[r=e.charAt(++l)])?r=e.charAt(++l):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),s=l+1);return a.push(e.slice(s,l)),a.join("")}}function M(e,t){return function(n){var r,i,o=xn(1900,void 0,1);if(L(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=kn(xn(o.y,0,1))).getUTCDay(),r=i>4||0===i?on.ceil(r):on(r),r=tn.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=wn(xn(o.y,0,1))).getDay(),r=i>4||0===i?_t.ceil(r):_t(r),r=jt.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?kn(xn(o.y,0,1)).getUTCDay():wn(xn(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,kn(o)):wn(o)}}function L(e,t,n,r){for(var i,o,a=0,l=t.length,s=n.length;a<l;){if(r>=s)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=k[i in Cn?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return y.x=x(n,y),y.X=x(r,y),y.c=x(t,y),w.x=x(n,w),w.X=x(r,w),w.c=x(t,w),{format:function(e){var t=x(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=M(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=x(e+="",w);return t.toString=function(){return e},t},utcParse:function(e){var t=M(e+="",!0);return t.toString=function(){return e},t}}}(e),Ln=Mn.format,Mn.parse,Mn.utcFormat,Mn.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Zr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Jr(e){return e.slice(0,10)}function Kr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Qr.apply(void 0,[function(e){return encodeURIComponent(e).replace(/%20/g,"+")},e].concat(n))}function Qr(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return r.reduce((function(n,r,i){return n.concat(e?e(r):String(r),t[i+1])}),[t[0]]).join("")}var ei=function e(t,n,r,i){var o;n[0]=0;for(var a=1;a<n.length;a++){var l=n[a++],s=n[a]?(n[0]|=l?1:2,r[n[a++]]):n[++a];3===l?i[0]=s:4===l?i[1]=Object.assign(i[1]||{},s):5===l?(i[1]=i[1]||{})[n[++a]]=s:6===l?i[1][n[++a]]+=s+"":l?(o=t.apply(s,e(t,s,r,["",null])),i.push(o),s[0]?n[0]|=2:(n[a-2]=0,n[a]=o)):i.push(s)}return i},ti=new Map;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var ni={exports:{}};ni.exports=function(){var e=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],t=function(e){return String(e).replace(/[&<>"']/g,(function(e){return"&"+n[e]+";"}))},n={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},r="dangerouslySetInnerHTML",i={className:"class",htmlFor:"for"},o={};function a(n,a){var l=[],s="";a=a||{};for(var u=arguments.length;u-- >2;)l.push(arguments[u]);if("function"==typeof n)return a.children=l.reverse(),n(a);if(n){if(s+="<"+n,a)for(var c in a)!1!==a[c]&&null!=a[c]&&c!==r&&(s+=" "+(i[c]?i[c]:t(c))+'="'+t(a[c])+'"');s+=">"}if(-1===e.indexOf(n)){if(a[r])s+=a[r].__html;else for(;l.length;){var h=l.pop();if(h)if(h.pop)for(var f=h.length;f--;)l.push(h[f]);else s+=!0===o[h]?h:t(h)}s+=n?"</"+n+">":""}return o[s]=!0,s}return a}();var ri,ii=function(e){var t=ti.get(this);return t||(t=new Map,ti.set(this,t)),(t=ei(this,t.get(e)||(t.set(e,t=function(e){for(var t,n,r=1,i="",o="",a=[0],l=function(e){1===r&&(e||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,e,i):3===r&&(e||i)?(a.push(3,e,i),r=2):2===r&&"..."===i&&e?a.push(4,e,0):2===r&&i&&!e?a.push(5,0,!0,i):r>=5&&((i||!e&&5===r)&&(a.push(r,0,i,n),r=6),e&&(a.push(r,e,0,n),r=6)),i=""},s=0;s<e.length;s++){s&&(1===r&&l(),l(s));for(var u=0;u<e[s].length;u++)t=e[s][u],1===r?"<"===t?(l(),a=[a],r=3):i+=t:4===r?"--"===i&&">"===t?(r=1,i=""):i=t+i[0]:o?t===o?o="":i+=t:'"'===t||"'"===t?o=t:">"===t?(l(),r=1):r&&("="===t?(r=5,n=i,i=""):"/"===t&&(r<5||">"===e[s][u+1])?(l(),3===r&&(a=a[0]),r=a,(a=a[0]).push(2,0,r),r=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(l(),r=2):i+=t),3===r&&"!--"===i&&(r=4,a=a[0])}return l(),a}(e)),t),arguments,[])).length>1?t:t[0]}.bind(ni.exports),oi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r(this,e),this.list=t,this.firstVisibleIndex=0,this.lastVisibleIndex=this.list.length-1}return o(e,[{key:"reset",value:function(){this.list=[],this.firstVisibleIndex=0,this.lastVisibleIndex=0}},{key:"setVisibleIndexRange",value:function(e,t){this.firstVisibleIndex=e,this.lastVisibleIndex=t}},{key:"push",value:function(){var e;return(e=this.list).push.apply(e,arguments)}},{key:"getAll",value:function(){return this.list}},{key:"getFirst",value:function(){return this.list[0]}},{key:"getLast",value:function(){return this.list[this.list.length-1]}},{key:"getFirstVisible",value:function(){return this.list[this.firstVisibleIndex]}},{key:"getLastVisible",value:function(){return this.list[this.lastVisibleIndex]}},{key:"forEachVisible",value:function(e){for(var t=this.firstVisibleIndex;t<=this.lastVisibleIndex;t+=1)e(this.list[t])}},{key:"findFirst",value:function(e){return this.list.find(e)}},{key:"findLast",value:function(e){for(var t=this.list.length-1;t>=0;t-=1){var n=this.list[t];if(e(n))return n}}},{key:"getAdjacentVisible",value:function(e,t){for(var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},i=t>0?function(){return e<n.lastVisibleIndex}:function(){return e>n.firstVisibleIndex};i();){e+=t;var o=this.list[e];if(o&&r(o))return o}}}]),e}(),ai=["x","y"],li=function(){function e(t){r(this,e),this.tolerance=t,this.buffer={}}return o(e,[{key:"reset",value:function(){this.buffer={}}},{key:"forEachPoint",value:function(e){for(var t in this.buffer){var n=this.buffer[t];for(var r in n)e(r,t,n[r])}}},{key:"putPoint",value:function(e){var t=e.x,n=e.y,r=l(e,ai);this.buffer[n]||(this.buffer[n]={}),this.buffer[n][t]=r}},{key:"getPoint",value:function(e,t){var n=this.buffer[t];return n?n[e]:void 0}},{key:"getPointWithTolerance",value:function(e,t){for(var n=e-this.tolerance,r=e+this.tolerance,i=t-this.tolerance,o=t+this.tolerance,a=i;a<=o;a+=1){var l=this.buffer[a];if(l)for(var s=n;s<=r;s+=1){var u=l[s];if(u)return u}}}}]),e}(),si=function(){function e(t){r(this,e),this.props=t,this.dimensions=null,this.element=null,this.ctx=null}return o(e,[{key:"initializeElement",value:function(){this.element=document.getElementById("plot")}},{key:"getDimensions",value:function(){return this.dimensions}},{key:"scale",value:function(){var e=b.timeline,t=e.plot.padding,n=e.legend.height,r=window.devicePixelRatio,i=window.innerWidth,o=window.innerHeight-(n+t);this.dimensions=[i,o],Object.assign(this.element,{width:i*r,height:o*r}),Object.assign(this.element.style,{width:"".concat(i,"px"),height:"".concat(o,"px")}),this.ctx=this.element.getContext("2d",{alpha:!1}),this.ctx.scale(r,r)}},{key:"drawBackground",value:function(){var e=b.timeline.plot.backgroundColor,t=u(this.dimensions,2),n=t[0],r=t[1];this.ctx.fillStyle=e,this.ctx.fillRect(0,0,n,r)}},{key:"drawTimeAxis",value:function(e,t,n,r){var i=b.timeline,o=i.plot.padding,a=i.timeAxis,l=a.width,s=a.timeFullColor,u=a.timeRangeColor,c=this.dimensions[1]-o;this.ctx.lineWidth=l,this.ctx.strokeStyle=s,this.ctx.beginPath(),this.ctx.moveTo(e,c),this.ctx.lineTo(t,c),this.ctx.stroke(),this.ctx.strokeStyle=u,this.ctx.beginPath(),this.ctx.moveTo(n,c),this.ctx.lineTo(r,c),this.ctx.stroke()}},{key:"drawPoint",value:function(e,t,n){var r=b.timeline.point.size,i=this.props.pointHalfSize;this.ctx.fillStyle=n,this.ctx.fillRect(e-i,t-i,r,r)}},{key:"afterRender",value:function(){this.initializeElement()}},{key:"render",value:function(){return ii(ri||(ri=s(['\n      <canvas\n        id="plot"\n        class="Plot"\n      />\n    '])))}}]),e}();function ui(e,t){return function(n){return e[n]=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t[n].apply(t,r)}}}var ci,hi,fi=function(){function e(t,n){r(this,e),this.props=t,this.plot=n,["getDimensions","scale","drawBackground","drawTimeAxis","drawPoint","render"].forEach(ui(this,this.plot))}return o(e,[{key:"subscribe",value:function(){var e=this.props,t=e.onMouseDown,n=e.onMouseUp,r=e.onMouseOut,i=e.onMouseMove,o=e.onWheel,a=this.plot.element;a.addEventListener("mousedown",t),a.addEventListener("mouseup",n),a.addEventListener("mouseout",r),a.addEventListener("mousemove",i),a.addEventListener("wheel",o)}},{key:"unsubscribe",value:function(){var e=this.props,t=e.onMouseDown,n=e.onMouseUp,r=e.onMouseOut,i=e.onMouseMove,o=e.onWheel,a=this.plot.element;a.removeEventListener("mousedown",t),a.removeEventListener("mouseup",n),a.removeEventListener("mouseout",r),a.removeEventListener("mousemove",i),a.removeEventListener("wheel",o)}},{key:"afterRender",value:function(){this.plot.afterRender(),this.subscribe()}}]),e}(),gi=function(){function e(t){r(this,e),this.props=t,this.element=null}return o(e,[{key:"initializeElement",value:function(){var e=b.timeline,t=e.plot.padding,n=e.timeAxis.width,r=e.legend.height,i=this.props,o=i.id,a=i.isMostTop,l=t-n/2;this.element=document.getElementById(o),Object.assign(this.element.style,{top:"calc(100% - ".concat(l+r+t,"px)"),lineHeight:"".concat(l,"px")}),a&&this.element.classList.add("TimeAxisLabel--most-top")}},{key:"clear",value:function(){this.element.innerText=""}},{key:"renderText",value:function(e,t,n){var r=b.timeline.point.size;this.element.innerText=t;var i=Math.ceil(this.element.offsetWidth/2),o=u(e-i<r?["".concat(r,"px"),"auto"]:e+i>n-r?["auto","".concat(r,"px")]:["".concat(e-i,"px"),"auto"],2),a=o[0],l=o[1];Object.assign(this.element.style,{left:a,right:l})}},{key:"afterRender",value:function(){this.initializeElement()}},{key:"render",value:function(){var e=this.props.id;return ii(ci||(ci=s(["\n      <aside\n        id=",'\n        class="TimeAxisLabel"\n      />\n    '])),e)}}]),e}(),di={exports:{}};hi=di,function(){var e={}.hasOwnProperty;function t(){for(var r=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var a=n(o);if("string"===a||"number"===a)r.push(o);else if(Array.isArray(o)){if(o.length){var l=t.apply(null,o);l&&r.push(l)}}else if("object"===a){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var s in o)e.call(o,s)&&o[s]&&r.push(s)}}}return r.join(" ")}hi.exports?(t.default=t,hi.exports=t):window.classNames=t}();var mi,bi,pi,vi,yi,wi,ki,xi,Mi,Li,Ci,Si,Ei,Ti,Di,Pi,Ai,Ni,Ri=di.exports,Ui=function(){function e(t){r(this,e),this.props=t}return o(e,[{key:"renderYearLink",value:function(e){var t=this.props.currentYear;return ii(mi||(mi=s(["\n      <a\n        class=",'\n        href="#','"\n      >\n        ',"\n      </a>\n    "])),Ri("YearNavigation__year-link",{"YearNavigation__year-link--current":t===e}),e,e)}},{key:"render",value:function(){var e=this.props.yearList;return ii(bi||(bi=s(['\n      <nav\n        class="YearNavigation list-box list-box--with-bg"\n      >\n        ',"\n      </nav>\n    "])),e.map(this.renderYearLink,this))}}]),e}(),Hi=function(){function e(t){r(this,e),this.props=t,this.introMessageElementList=null,this.scrobbleInfoElementList=null,this.artistNameElement=null,this.albumNameElement=null,this.trackNameElement=null}return o(e,[{key:"initializeElements",value:function(){this.introMessageElementList=document.querySelectorAll(".InfoBox__field--intro-message"),this.scrobbleInfoElementList=document.querySelectorAll(".InfoBox__field--scrobble-info"),this.artistNameElement=document.getElementById("info-box-field-artist-name"),this.albumNameElement=document.getElementById("info-box-field-album-name"),this.trackNameElement=document.getElementById("info-box-field-track-name")}},{key:"showIntroMessage",value:function(){this.introMessageElementList.forEach((function(e){return e.style.display="block"})),this.scrobbleInfoElementList.forEach((function(e){return e.style.display="none"}))}},{key:"hideIntroMessage",value:function(){this.introMessageElementList.forEach((function(e){return e.style.display="none"}))}},{key:"getLastfmLinks",value:function(){var e=b.links,t=this.props,n=t.dates,r=t.summary,i="".concat(e.lastfm.url,"library"),o=Jr(n.firstScrobbleDate),a=Jr(n.lastScrobbleDate),l="from=".concat(o,"&to=").concat(a);return{scrobbleListLink:ii(pi||(pi=s(['\n        <a href="',"?",'">',"</a>\n      "])),i,l,r.scrobbleCount),artistListLink:ii(vi||(vi=s(['\n        <a href="',"/artists?",'">',"</a>\n      "])),i,l,r.artistCount),albumListLink:ii(yi||(yi=s(['\n        <a href="',"/albums?",'">',"</a>\n      "])),i,l,r.albumCount),trackListLink:ii(wi||(wi=s(['\n        <a href="',"/tracks?",'">',"</a>\n      "])),i,l,r.trackCount)}}},{key:"renderScrobbleInfo",value:function(e,t){var n=e.artist,r=e.album,i=e.track,o=Kr(ki||(ki=s(["https://www.last.fm/music/",""])),n.name),a=Kr(xi||(xi=s(["https://www.last.fm/music/","/",""])),n.name,r.name),l=Kr(Mi||(Mi=s(["https://www.last.fm/music/","/_/",""])),n.name,i.name);this.artistNameElement.style.display="block",this.artistNameElement.innerHTML=ii(Li||(Li=s(["\n      <span>\n        <a href=",">","</a> <small>(","/",")</small>\n      </span>\n    "])),o,n.name,n.playcount,t.artist),this.albumNameElement.style.display=r.name?"block":"none",this.albumNameElement.innerHTML=r.name?ii(Ci||(Ci=s(["\n        <span>\n          <a href=",">","</a> <small>(","/",")</small>\n        </span>\n      "])),a,r.name,r.playcount,t.album):"",this.trackNameElement.style.display="block",this.trackNameElement.innerHTML=ii(Si||(Si=s(["\n      <span>\n        <a href=",">","</a> <small>(","/",")</small>\n      </span>\n    "])),l,i.name,i.playcount,t.track)}},{key:"afterRender",value:function(){this.initializeElements()}},{key:"render",value:function(){var e=this.props.summary,t=this.getLastfmLinks(),n=t.scrobbleListLink,r=t.artistListLink,i=t.albumListLink,o=t.trackListLink;return ii(Ei||(Ei=s(['\n      <aside\n        class="InfoBox list-box list-box--with-rows list-box--with-bg"\n      >\n        <p\n          class="InfoBox__field--intro-message list-box__field"\n        >\n          '," scrobbles (",' per day)\n        </p>\n\n        <p\n          class="InfoBox__field--intro-message list-box__field"\n        >\n          '," artists, "," albums, ",' tracks\n        </p>\n\n        <p\n          id="info-box-field-artist-name"\n          class="InfoBox__field--scrobble-info list-box__field"\n        />\n\n        <p\n          id="info-box-field-album-name"\n          class="InfoBox__field--scrobble-info list-box__field"\n        />\n\n        <p\n          id="info-box-field-track-name"\n          class="InfoBox__field--scrobble-info list-box__field"\n        />\n      </aside>\n    '])),n,e.scrobblePerDayCount,r,i,o)}}]),e}(),Fi=function(){function e(){r(this,e)}return o(e,[{key:"render",value:function(){var e=b.links,t=e.github,n=e.twitter;return ii(Ti||(Ti=s(['\n      <aside\n        class="ExternalLinks list-box list-box--with-rows list-box--with-bg"\n      >\n        <p\n          class="ExternalLinks__field list-box__field"\n        >\n          <a\n            class="ExternalLinks__link"\n            href=',"\n          >\n            ",'\n          </a>\n        </p>\n\n        <p\n          class="ExternalLinks__field list-box__field"\n        >\n          <a\n            class="ExternalLinks__link"\n            href=',"\n          >\n            ",'\n          </a>\n        </p>\n\n        <p\n          class="ExternalLinks__field list-box__field"\n        >\n          <a\n            class="ExternalLinks__link ExternalLinks__link--grid"\n            href="https://supportukrainenow.org/"\n          >\n            <span>#StandWithUkraine<//>\n\n            <img\n              class="ExternalLinks__flag"\n              src="flag-ua-1x1.svg" alt="Flag of Ukraine"\n            />\n          </a>\n        </p>\n      </aside>\n    '])),n.url,n.text,t.url,t.text)}}]),e}(),ji=function(){function e(t){r(this,e),this.props=t,this.element=null,this.genreElementCollection=[],this.genreList=function(e){var t=b.timeline.point.colorValueFactors,n=b.genreGroups,r={},i=[],o={};for(var a in e.forEach((function(e){var t=e.artist,n=t.name,i=t.playcount,a=t.genreGroup,l=t.genre;if(l){var s=r[l];s||(s={genreGroup:a,artistCount:0,playcount:0},r[l]=s),o[n]?s.playcount=s.playcount-o[n]+i:(s.artistCount+=1,s.playcount+=i),o[n]=i}})),r){var l=r[a],s=l.artistCount,c=l.playcount,h=l.genreGroup,f=n[h];if(f){var g=u(f.colorRange,1)[0],d=V(g),m=V(g);d.s*=t.other.saturation,d.l*=t.other.lightness,m.s*=t.genre.saturation,m.l*=t.genre.lightness,[d,m].forEach((function(e){e.s>1&&(e.s=1),e.l>1&&(e.l=1)})),i.push({name:a,group:h,artistCount:s,playcount:c,color:d,highlightedColor:m})}else console.warn("genre not found in the config: ".concat(a))}return i.sort((function(e,t){return t.playcount-e.playcount}))}(t.scrobbleList),this.heightScale=this.getHeightScale()}return o(e,[{key:"initializeElements",value:function(){this.element=document.getElementById("legend"),this.genreElementCollection=this.element.getElementsByClassName("Legend__genre")}},{key:"getHeightScale",value:function(){var e=b.timeline.legend.height,t=Math.max.apply(Math,c(this.genreList.map((function(e){return e.playcount}))));return Lt().domain([0,t]).range([0,e])}},{key:"afterRender",value:function(){this.initializeElements(),requestAnimationFrame(this.setGenreElementsHeight.bind(this))}},{key:"setGenreElementsHeight",value:function(){for(var e=0;e<this.genreElementCollection.length;e+=1){var t=this.genreElementCollection[e],n=this.genreList[e].playcount,r=Math.max(this.heightScale(n),1);t.style.height="".concat(r,"px")}}},{key:"renderGenre",value:function(e){var t=e.name,n=e.artistCount,r=e.playcount,i=e.color,o=this.props.scrobbleList,a=["".concat(n," artist").concat(n>1?"s":""),"".concat(r," scrobble").concat(r>1?"s":""," (").concat((100*r/o.length).toFixed(1),"%)")].join(", ");return ii(Di||(Di=s(['\n      <section\n        class="Legend__genre"\n        style="background-color: ','"\n        title=','\n      >\n        <span\n          class="Legend__genre-caption"\n        >\n          ',"\n        </span>\n      </section>\n    "])),i,a,t)}},{key:"render",value:function(){return ii(Pi||(Pi=s(['\n      <nav\n        id="legend"\n        class="Legend"\n      >\n        ',"\n      </nav>\n    "])),this.genreList.map(this.renderGenre,this))}}]),e}(),Ii=function(){function e(t,n){r(this,e),this.props=t,this.legend=n,this.highlightedGenreIndex=null,this.eventListeners={},ui(this,this.legend)("render")}return o(e,[{key:"subscribe",value:function(){for(var e=this,t=this.props.onGenreMouseEnter,n=this.legend,r=n.genreElementCollection,i=n.genreList,o=function(n){var o=r[n],a=i[n].name,l=function(){return t(a)};e.eventListeners[a]=l,o.addEventListener("mouseenter",l)},a=0;a<r.length;a+=1)o(a)}},{key:"unsubscribe",value:function(){for(var e=this.legend,t=e.genreElementCollection,n=e.genreList,r=0;r<t.length;r+=1){var i=t[r],o=n[r].name;i.removeEventListener("mouseenter",this.eventListeners[o])}}},{key:"highlightGenre",value:function(e){var t=this.legend,n=t.genreElementCollection,r=t.genreList,i=r.findIndex((function(t){return t.name===e})),o=n[i],a=r[i].highlightedColor;o.classList.add("Legend__genre--highlighted"),o.style.backgroundColor=a,this.highlightedGenreIndex=i}},{key:"removeGenreHighlight",value:function(){if(null!==this.highlightedGenreIndex){var e=this.legend,t=e.genreElementCollection,n=e.genreList,r=t[this.highlightedGenreIndex],i=n[this.highlightedGenreIndex].color;r.classList.remove("Legend__genre--highlighted"),r.style.backgroundColor=i,this.highlightedGenreIndex=null}}},{key:"afterRender",value:function(){this.legend.afterRender(),this.subscribe()}}]),e}(),Oi=function(){function e(){r(this,e),this.element=null,this.highlightedLabelElement=null,this.bboxList=[]}return o(e,[{key:"initializeElements",value:function(){this.element=document.getElementById("artist-labels")}},{key:"removeAllLabels",value:function(){this.element.innerHTML="",this.highlightedLabelElement=null,this.bboxList=[]}},{key:"getLabelMinX",value:function(e,t,n){var r=b.timeline.labels.areaPadding,i=Math.ceil(t/2);return e-i<r?r:e+i>n-r?n-r-t:e-i}},{key:"getLabelMinY",value:function(e,t,n,r){var i,o=b.timeline,a=o.point.size,l=o.labels.margin,s=this.bboxList.filter((function(n){return!(e>n.maxX+l||t<n.minX-l)})).sort((function(e,t){return t.minY-e.minY})),u=n-a,c=u-r,f=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(s);try{for(f.s();!(i=f.n()).done;){var g=i.value;u<g.minY-l||c>g.maxY+l||(c=(u=g.minY-l)-r)}}catch(e){f.e(e)}finally{f.f()}return c}},{key:"renderLabel",value:function(e,t){var n=e.x,r=e.y,i=e.text,o=e.scrobble.artistLabelColor,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=b.timeline.labels.highlightedColor,s=document.createElement("span"),u=a?l:o;s.classList.add("ArtistLabelCollection__label"),s.innerText=i,a&&(this.highlightedLabelElement&&this.highlightedLabelElement.classList.remove("ArtistLabelCollection__label--highlighted"),s.classList.add("ArtistLabelCollection__label--highlighted"),this.highlightedLabelElement=s),this.element.appendChild(s);var c=s.offsetWidth,h=s.offsetHeight,f=this.getLabelMinX(n,c,t),g=f+c,d=this.getLabelMinY(f,g,r,h),m=d+h;this.bboxList.push({minX:f,minY:d,maxX:g,maxY:m}),Object.assign(s.style,{top:"".concat(d,"px"),left:"".concat(f,"px"),color:u})}},{key:"afterRender",value:function(){this.initializeElements()}},{key:"render",value:function(){var e=b.timeline,t=e.plot.padding,n=e.legend.height;return ii(Ai||(Ai=s(['\n      <aside\n        id="artist-labels"\n        class="ArtistLabelCollection"\n        style="bottom: ','px"\n      />\n    '])),n+t)}}]),e}(),_i=function(){function e(t){r(this,e);var n=b.timeline.point.size,i=t.scrobbleList;this.props=t,this.children={},this.scrobbleHalfSize=Math.ceil(n/2),this.scrobbleCollection=new oi(i),this.pointBuffer=new li(this.scrobbleHalfSize),this.plotScales={}}return o(e,[{key:"initializeChildrenComponents",value:function(){var e=b.timeline.timeAxis.tickLabelCount,t=this.props,n=t.summary,r=t.yearList,i=t.scrobbleList,o=t.onPlotMouseDown,a=t.onPlotMouseUp,l=t.onPlotMouseOut,s=t.onPlotMouseMove,u=t.onPlotWheel,c=t.onLegendGenreMouseEnter;this.children.plot=new fi({onMouseDown:o,onMouseUp:a,onMouseOut:l,onMouseMove:s,onWheel:u},new si({pointHalfSize:this.scrobbleHalfSize})),this.children.yearNavigation=new Ui({currentYear:document.location.hash.slice(1),yearList:r}),this.children.infoBox=new Hi({dates:{firstScrobbleDate:this.scrobbleCollection.getFirst().date,lastScrobbleDate:this.scrobbleCollection.getLast().date},summary:n}),this.children.externalLinks=new Fi,this.children.selectedScrobbleTimeLabel=new gi({id:"selected-scrobble-time-label",isMostTop:!0});for(var h=0;h<e;h+=1)this.children["timeTickLabel".concat(h)]=new gi({id:"time-tick-label--".concat(h)});this.children.legend=new Ii({onGenreMouseEnter:c},new ji({scrobbleList:i})),this.children.artistLabelCollection=new Oi}},{key:"getPlotScales",value:function(){for(var e=b.timeline,t=e.plot.padding,n=e.point,r=n.size,i=n.maxMargin,o=e.timeAxis.width,a=e.labels,l=a.areaPadding,s=a.highlightedHeight,c=this.props.summary,h=u(this.children.plot.getDimensions(),2),f=h[0],g=h[1]-t-o/2-r,d=g-l-s-r,m=i,p=d;m>=0;){var v=(c.maxArtistPlaycount-1)*(r+m);if(!(v>d)){p=v;break}m-=1}var y=g-p,w=t,k=f-t;return{timeAxis:Vr().domain([this.scrobbleCollection.getFirst().timestamp,this.scrobbleCollection.getLast().timestamp]).rangeRound([w,k]),x:Vr().domain([this.scrobbleCollection.getFirstVisible().timestamp,this.scrobbleCollection.getLastVisible().timestamp]).rangeRound([w,k]),y:Lt().domain([1,c.maxArtistPlaycount]).rangeRound([g,y])}}},{key:"createScrobblePoint",value:function(e){var t=e.timestamp,n=e.artist;return{x:this.plotScales.x(t),y:this.plotScales.y(n.playcount),scrobble:e}}},{key:"draw",value:function(){var e=this,t=b.timeline.timeAxis.tickLabelCount,n=this.props.onScrobblePointCreate,r=this.plotScales,i=r.timeAxis,o=r.x,a=this.children.plot,l=a.getDimensions()[0],s=u(o.domain(),2),c=s[0],h=s[1],f=u(o.range(),2),g=f[0],d=f[1],m=i(c),p=i(h),v=o.ticks(l>600?12:4),y=o.tickFormat();a.drawBackground(),this.scrobbleCollection.forEachVisible((function(t){var r=e.createScrobblePoint(t);e.pointBuffer.putPoint(r),n(r)})),this.pointBuffer.forEachPoint((function(e,t,n){var r=n.scrobble.color;return a.drawPoint(e,t,r)})),a.drawTimeAxis(g,d,m,p),v.forEach((function(t,n){e.children["timeTickLabel".concat(n)].renderText(o(t),y(t),l)}));for(var w=v.length;w<t;w+=1)this.children["timeTickLabel".concat(w)].clear()}},{key:"beforeRender",value:function(){this.initializeChildrenComponents()}},{key:"afterRender",value:function(){var e=this.children.plot;Object.values(this.children).forEach((function(e){"function"==typeof e.afterRender&&e.afterRender()})),e.scale(),this.plotScales=this.getPlotScales()}},{key:"render",value:function(){return ii(Ni||(Ni=s(["\n      <main>\n        ","\n      </main>\n    "])),Object.values(this.children).map((function(e){return e.render()})))}}]),e}();function zi(e,t,n){return Math.min(Math.max(e,t),n)}var Yi,Gi=function(){function e(t){r(this,e),this.getKey=t,this.registry={}}return o(e,[{key:"reset",value:function(){this.registry={}}},{key:"putItem",value:function(e){var t=this.getKey(e);t&&(this.registry[t]||(this.registry[t]=[]),this.registry[t].push(e))}},{key:"getItemList",value:function(e){return this.registry[e]||[]}},{key:"filter",value:function(e){var t={};for(var n in this.registry){var r=this.registry[n];e(r)&&(t[n]=r)}return t}}]),e}(),Bi=function(){function e(t,n){r(this,e),this.props=t,this.timeline=n,this.selectedScrobble=null,this.pointCollectionHighlighted=new oi,this.genrePointRegistry=new Gi((function(e){return e.scrobble.artist.genre})),this.artistPointRegistry=new Gi((function(e){return e.scrobble.artist.name})),this.isPlotMouseDown=!1,this.plotMouseX=null,Object.assign(this.timeline.props,{onScrobblePointCreate:this.handleScrobblePointCreate.bind(this),onPlotMouseDown:this.handlePlotMouseDown.bind(this),onPlotMouseUp:this.handlePlotMouseUpOrOut.bind(this),onPlotMouseOut:this.handlePlotMouseUpOrOut.bind(this),onPlotMouseMove:this.handlePlotMouseMove.bind(this),onPlotWheel:this.handlePlotWheel.bind(this),onLegendGenreMouseEnter:this.handleLegendGenreMouseEnter.bind(this)}),["draw","beforeRender","render"].forEach(ui(this,this.timeline)),this.handleWindowResize=this.handleWindowResize.bind(this),this.handleDocumentKeydown=this.handleDocumentKeydown.bind(this)}return o(e,[{key:"subscribe",value:function(){window.addEventListener("resize",this.handleWindowResize),document.addEventListener("keydown",this.handleDocumentKeydown)}},{key:"unsubscribe",value:function(){Object.values(this.timeline.children).forEach((function(e){"function"==typeof e.unsubscribe&&e.unsubscribe()})),window.removeEventListener("resize",this.handleWindowResize),document.removeEventListener("keydown",this.handleDocumentKeydown)}},{key:"resetScales",value:function(){this.timeline.children.plot.scale(),this.timeline.plotScales=this.timeline.getPlotScales()}},{key:"resetState",value:function(){this.timeline.pointBuffer.reset(),this.genrePointRegistry.reset(),this.artistPointRegistry.reset(),this.pointCollectionHighlighted.reset(),this.selectedScrobble=null}},{key:"resetUi",value:function(){var e=this.timeline.children,t=e.infoBox,n=e.selectedScrobbleTimeLabel,r=e.legend,i=e.artistLabelCollection;t.showIntroMessage(),n.clear(),r.removeGenreHighlight(),i.removeAllLabels()}},{key:"highlightGenre",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.timeline.children.plot,i={};return this.genrePointRegistry.getItemList(e).forEach((function(e){var o=e.x,a=e.y,l=e.scrobble,s=l.artist.name,u=l.highlightedGenreColor;s!==n&&(t.pointCollectionHighlighted.push({x:o,y:a}),i[s]=e,r.drawPoint(o,a,u))})),i}},{key:"highlightArtist",value:function(e){var t=this,n=e.index,r=e.artist,i=e.track,o=b.timeline.point.selectedColor,a=this.timeline.children,l=a.plot,s=a.selectedScrobbleTimeLabel,c=u(l.getDimensions(),1)[0],h=[],f=null;return this.artistPointRegistry.getItemList(r.name).forEach((function(e){var r=e.x,o=e.y,a=e.scrobble,g=a.index,d=a.timestamp,m=a.track.name,b=a.highlightedArtistColor;t.pointCollectionHighlighted.push({x:r,y:o}),f=e,m===i.name?h.push({x:r,y:o}):l.drawPoint(r,o,b),g===n&&s.renderText(r,function(e){var t=new Date(e),n=Zr[t.getMonth()],r=u([t.getDate(),t.getHours(),t.getMinutes()].map((function(e){return e.toString().padStart(2,"0")})),3),i=r[0],o=r[1],a=r[2];return"".concat(n," ").concat(i," ").concat(o,":").concat(a)}(d),c)})),h.forEach((function(e){var t=e.x,n=e.y;return l.drawPoint(t,n,o)})),f}},{key:"removePointsHighlight",value:function(){var e=this.timeline.pointBuffer,t=this.timeline.children.plot;this.pointCollectionHighlighted.getAll().forEach((function(n){var r=n.x,i=n.y;return t.drawPoint(r,i,e.getPoint(r,i).scrobble.color)})),this.pointCollectionHighlighted.reset()}},{key:"selectGenre",value:function(e){var t=this.timeline.children.legend;this.selectedScrobble=null,this.removePointsHighlight(),this.resetUi(),this.renderArtistsLabels(this.highlightGenre(e)),t.highlightGenre(e)}},{key:"selectScrobble",value:function(e){var n=this.props.summary,r=this.timeline.children,i=r.plot,o=r.infoBox,a=r.legend,l=r.artistLabelCollection,s=u(i.getDimensions(),1)[0],c=e.artist,h=!(this.selectedScrobble&&this.selectedScrobble.artist.name===c.name),f={};this.selectedScrobble=e,this.removePointsHighlight(),o.hideIntroMessage(),h&&(a.removeGenreHighlight(),l.removeAllLabels()),c.genre&&(f=this.highlightGenre(c.genre,c.name),h&&a.highlightGenre(c.genre));var g=this.highlightArtist(e);h&&(l.renderLabel(t({text:c.name},g),s,!0),this.renderArtistsLabels(f)),o.renderScrobbleInfo(e,n.getScrobbleTotals(e))}},{key:"selectVerticallyAdjacentScrobble",value:function(e){var t=this.timeline.scrobbleCollection;if(this.selectedScrobble){var n=t.getAdjacentVisible(this.selectedScrobble.index,e);n&&this.selectScrobble(n)}}},{key:"selectHorizontallyAdjacentScrobble",value:function(e){var t=this,n=this.timeline.scrobbleCollection;if(this.selectedScrobble){var r=n.getAdjacentVisible(this.selectedScrobble.index,e,(function(e){return e.artist.playcount===t.selectedScrobble.artist.playcount}));r&&this.selectScrobble(r)}}},{key:"selectScrobbleUnderMouse",value:function(e){var t=this.timeline.pointBuffer,n=e.offsetX,r=e.offsetY,i=t.getPointWithTolerance(n,r);i&&i.scrobble!==this.selectedScrobble&&this.selectScrobble(i.scrobble)}},{key:"panPlot",value:function(e){var t=this.timeline,n=t.scrobbleCollection,r=t.plotScales.x,i=e.offsetX,o=n.getFirst().timestamp,a=n.getLast().timestamp,l=r.domain().map((function(e){return Date.parse(e)})),s=u(l,2),c=s[0],h=s[1];if(!(h-c>=a-o)){var f=r.invert(this.plotMouseX)-r.invert(i);f&&(h+f>a?f=a-h:c+f<o&&(f=o-c),f&&this.updatePlotTimeRange(c+f,h+f))}}},{key:"zoomPlot",value:function(e){var t=b.timeline,n=t.zoomDeltaFactor,r=t.minTimeRange,i=t.plot.padding,o=this.timeline,a=o.scrobbleCollection,l=o.plotScales.x,s=this.timeline.children.plot,h=e.offsetX,f=e.deltaY,g=l.domain(),d=u(s.getDimensions(),1)[0]-2*i,m=Lt().domain([0,d]).rangeRound(g),p=m(zi.apply(void 0,[h-i].concat(c(m.domain())))),v=1-f*n,y=(p-g[0])/v,w=(g[1]-p)/v;y+w>=r&&this.updatePlotTimeRange(Math.max(p-y,a.getFirst().timestamp),Math.min(p+w,a.getLast().timestamp))}},{key:"updatePlotTimeRange",value:function(e,t){var n=this.timeline,r=n.scrobbleCollection,i=n.plotScales.x,o=r.findFirst((function(t){return t.timestamp>=e})).index,a=r.findLast((function(e){return e.timestamp<=t})).index;i.domain([e,t]),r.setVisibleIndexRange(o,a),this.resetState(),this.draw(),this.resetUi()}},{key:"handleScrobblePointCreate",value:function(e){this.genrePointRegistry.putItem(e),this.artistPointRegistry.putItem(e)}},{key:"handleWindowResize",value:function(){var e=this;clearTimeout(this.windowResizeTimeoutHandle),this.windowResizeTimeoutHandle=setTimeout((function(){e.resetScales(),e.resetState(),e.draw(),e.resetUi()}),100)}},{key:"handleDocumentKeydown",value:function(e){switch(e.key){case"Escape":return this.handleEscKeydown();case"ArrowDown":return this.selectVerticallyAdjacentScrobble(-1);case"ArrowUp":return this.selectVerticallyAdjacentScrobble(1);case"ArrowLeft":return this.selectHorizontallyAdjacentScrobble(-1);case"ArrowRight":return this.selectHorizontallyAdjacentScrobble(1)}}},{key:"handleEscKeydown",value:function(){this.selectedScrobble=null,this.removePointsHighlight(),this.resetUi()}},{key:"handlePlotMouseDown",value:function(e){0===e.button&&(this.isPlotMouseDown=!0)}},{key:"handlePlotMouseUpOrOut",value:function(){this.isPlotMouseDown=!1}},{key:"handlePlotMouseMove",value:function(e){var t=e.offsetX;this.isPlotMouseDown?this.panPlot(e):this.selectScrobbleUnderMouse(e),this.plotMouseX=t}},{key:"handlePlotWheel",value:function(e){e.preventDefault(),this.zoomPlot(e)}},{key:"handleLegendGenreMouseEnter",value:function(e){this.selectGenre(e)}},{key:"afterRender",value:function(){this.timeline.afterRender(),this.subscribe()}},{key:"renderArtistsLabels",value:function(e){var n=this.timeline.children,r=n.plot,i=n.artistLabelCollection,o=u(r.getDimensions(),1)[0];Object.entries(e).map((function(e){var n=u(e,2);return t({text:n[0]},n[1])})).sort((function(e,t){return t.y-e.y})).forEach((function(e){return i.renderLabel(e,o,!1)}))}}]),e}(),Vi={},qi=null;function Wi(e){return Vi[e]?Promise.resolve(Vi[e]):fetch(e).then((function(e){return e.json()})).then((function(t){return Vi[e]=t}))}function $i(e){var n=u(e,3),r=n[0],i=n[1],o=n[2],a=i.map((function(e,n){return t(t({},function(e){var t=u(e,7);return{date:t[0],track:{name:t[1],playcount:t[2]},album:{name:t[3],playcount:t[4]},artist:{name:t[5],playcount:t[6]}}}(e)),{},{index:n,timestamp:(r=e[0],Date.parse(r.replace(" ","T")))});var r})),l=function(e){var t={};e.forEach((function(e){var n=e.artist,r=e.album,i=e.track;t[n.name]||(t[n.name]={albums:{},tracks:{}}),t[n.name].playcount=n.playcount,r.name&&(t[n.name].albums[r.name]=r.playcount),t[n.name].tracks[i.name]=i.playcount}));var n=Object.keys(t).length,r=0,i=0,o=0,a=0;for(var l in t){var s=t[l],u=s.playcount,c=s.albums,h=s.tracks;for(var f in r+=Object.keys(c).length,i+=Object.keys(h).length,u>o&&(o=u),c){var g=c[f];g>a&&(a=g)}}var d=e.length,m=Math.ceil((e[e.length-1].timestamp-e[0].timestamp)/864e5);return{artistCount:n,albumCount:r,trackCount:i,maxArtistPlaycount:o,maxAlbumPlaycount:a,scrobbleCount:d,scrobblePerDayCount:Math.round(10*d/m)/10,getScrobbleTotals:function(e){var n=e.artist,r=e.album,i=e.track,o=t[n.name],a=o.playcount,l=o.albums,s=o.tracks;return{artist:a,album:l[r.name],track:s[i.name]}}}}(a);return{yearList:r,summary:l,scrobbleList:Xr(Z(a,o),l.maxAlbumPlaycount)}}function Xi(e){var t=new Bi(e,new _i(e));return qi&&qi.unsubscribe(),t.beforeRender(),document.body.innerHTML=t.render(),t.afterRender(),t.draw(),qi=t,t}function Zi(e){}function Ji(e){var t;(t=[b.dataUrls.yearList,"".concat(b.dataUrls.yearsBase,"/").concat(e,".json"),b.dataUrls.artistsByGenres],Promise.all(t.map(Wi))).then($i).then(Xi).then(Zi)}new d(a({"":function(){return document.location.hash=b.defaultDataYear},all:Ji},function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(t,n,r){return t.concat("(".concat(g(n),")"),e[r+1])}),[e[0]]).join("")}(Yi||(Yi=s(["",""])),/\d{4}/),Ji)).start();
//# sourceMappingURL=bundle.min.js.map
